(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     46789,       1101]
NotebookOptionsPosition[     45453,       1066]
NotebookOutlinePosition[     45807,       1082]
CellTagsIndexPosition[     45764,       1079]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", 
  RowBox[{"Evaluate", "[", 
   RowBox[{"$Context", "<>", "\"\<*\>\""}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7078182120555887`*^9, 3.707818225044613*^9}, 
   3.707834454141575*^9},ExpressionUUID->"7970e5e9-c54e-4918-8772-\
9d4220a149e0"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"UTILITY", " ", 
   RowBox[{"FUNCTION", ":", " ", 
    RowBox[{"Hu", " ", "Moments"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.70783471194095*^9, 
  3.707834759785977*^9}},ExpressionUUID->"c7e5a6ef-c5ca-4d46-8086-\
3f28663edd08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"imageMoments", "[", "img_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "pixels", ",", "xArr", ",", "yArr", ",", "w", ",", "h", ",", "m00", ",", 
      " ", "moment", ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"centroid", "=", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
      
      RowBox[{"\[Mu]", "=", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"\[Eta]", "=", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}]}], "\n", "\t", "}"}], ",", "\n", "\t", "\n", "\t", 
    RowBox[{
     RowBox[{"pixels", "=", 
      RowBox[{"ImageData", "[", "img", "]"}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{"w", "=", " ", 
      RowBox[{
       RowBox[{"ImageDimensions", "[", "img", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"h", "=", " ", 
      RowBox[{
       RowBox[{"ImageDimensions", "[", "img", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"xArr", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Range", "[", "w", "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"yArr", "=", 
      RowBox[{"N", "[", 
       RowBox[{"Range", "[", "h", "]"}], "]"}]}], ";", "\n", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", " ", 
      RowBox[{
      "computes", " ", "image", " ", "moments", " ", "the", " ", "result", 
       " ", "of", " ", "two", " ", "dot", " ", "operation", " ", "is", " ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ImageData", "[", 
           RowBox[{"[", 
            RowBox[{"x", ",", "y"}], "]"}], "]"}], " ", 
          RowBox[{"x", "^", "j"}], "*", 
          RowBox[{"y", "^", "i"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1", ",", "w"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "1", ",", "h"}], "}"}]}], "]"}], " ", "which", 
       " ", "is", " ", "exactly", " ", "the", " ", "same", " ", "expression", 
       " ", "as", " ", "in", " ", "the", " ", "moment", " ", 
       RowBox[{"definition", ".", "However"}], " ", "the", " ", "Dot", " ", 
       "operation", " ", "is", " ", "very", " ", 
       RowBox[{"fast", "."}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"moment", "[", 
       RowBox[{"k_", ",", "m_"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"yArr", "^", "m"}], ")"}], ".", "pixels", ".", 
       RowBox[{"(", 
        RowBox[{"xArr", "^", "k"}], ")"}]}]}], ";", "\n", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{"Centroid", " ", "calculations"}], "*)"}], 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"m00", " ", "=", " ", 
      RowBox[{"moment", "[", 
       RowBox[{"0", ",", "0"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"m00", " ", "\[Equal]", " ", "0"}], ",", " ", 
       RowBox[{"m00", " ", "=", " ", "$MachineEpsilon"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"centroid", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"1", ",", "0"}], "]"}], "/", "m00"}]}], ";", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"centroid", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"0", ",", "1"}], "]"}], "/", "m00"}]}], ";", "\n", "\t", "\n",
      "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Central", " ", "momets", " ", "\[Mu]", " ", 
        RowBox[{"https", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
        "Image_moment"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"2", ",", "0"}], "]"}], "-", 
       RowBox[{
        RowBox[{"centroid", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"[", "2", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "-", 
       RowBox[{
        RowBox[{"centroid", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"0", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"[", "3", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"0", ",", "2"}], "]"}], "-", 
       RowBox[{
        RowBox[{"centroid", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"0", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"[", "4", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"3", ",", "0"}], "]"}], "-", 
       RowBox[{"3", 
        RowBox[{"centroid", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], "+", 
       RowBox[{"2", 
        SuperscriptBox[
         RowBox[{"centroid", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "2"], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"[", "5", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"centroid", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"centroid", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], "+", 
       RowBox[{"2", 
        SuperscriptBox[
         RowBox[{"centroid", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "2"], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"0", ",", "1"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"[", "6", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "-", 
       RowBox[{"2", 
        RowBox[{"centroid", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"centroid", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"0", ",", "2"}], "]"}]}], "+", 
       RowBox[{"2", 
        SuperscriptBox[
         RowBox[{"centroid", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "2"], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
     "\t", 
     RowBox[{
      RowBox[{"\[Mu]", "[", 
       RowBox[{"[", "7", "]"}], "]"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"moment", "[", 
        RowBox[{"0", ",", "3"}], "]"}], "-", 
       RowBox[{"3", 
        RowBox[{"centroid", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"0", ",", "2"}], "]"}]}], "+", 
       RowBox[{"2", 
        SuperscriptBox[
         RowBox[{"centroid", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "2"], "*", 
        RowBox[{"moment", "[", 
         RowBox[{"0", ",", "1"}], "]"}]}]}]}], ";", "\n", "\t", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "normilized", " ", "entral", " ", "momets", " ", "\[Mu]", " ", 
        RowBox[{"https", ":"}]}], "//", 
       RowBox[{
        RowBox[{
         RowBox[{"en", ".", "wikipedia", ".", "org"}], "/", "wiki"}], "/", 
        "Image_moment"}]}], "*)"}], "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "=", 
      FractionBox[
       RowBox[{"\[Mu]", "[", 
        RowBox[{"[", "1", "]"}], "]"}], 
       SuperscriptBox["m00", "2"]]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "=", 
      FractionBox[
       RowBox[{"\[Mu]", "[", 
        RowBox[{"[", "2", "]"}], "]"}], 
       SuperscriptBox["m00", "2"]]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "=", 
      FractionBox[
       RowBox[{"\[Mu]", "[", 
        RowBox[{"[", "3", "]"}], "]"}], 
       SuperscriptBox["m00", "2"]]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "=", 
      FractionBox[
       RowBox[{"\[Mu]", "[", 
        RowBox[{"[", "4", "]"}], "]"}], 
       SuperscriptBox["m00", "2.5"]]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"[", "5", "]"}], "]"}], "=", 
      FractionBox[
       RowBox[{"\[Mu]", "[", 
        RowBox[{"[", "5", "]"}], "]"}], 
       SuperscriptBox["m00", "2.5"]]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "=", 
      FractionBox[
       RowBox[{"\[Mu]", "[", 
        RowBox[{"[", "6", "]"}], "]"}], 
       SuperscriptBox["m00", "2.5"]]}], ";", "\n", "\t", 
     RowBox[{
      RowBox[{"\[Eta]", "[", 
       RowBox[{"[", "7", "]"}], "]"}], "=", 
      FractionBox[
       RowBox[{"\[Mu]", "[", 
        RowBox[{"[", "7", "]"}], "]"}], 
       SuperscriptBox["m00", "2.5"]]}], ";", "\n", "\t", "\[Eta]"}]}], "\n", 
   "]"}]}]], "Code",
 CellChangeTimes->{{3.657883262652023*^9, 3.6578833311933203`*^9}, {
   3.657883366942994*^9, 3.6578833705082855`*^9}, {3.6578834834404926`*^9, 
   3.6578835291823745`*^9}, {3.657884086171565*^9, 3.6578841050544786`*^9}, {
   3.6578842480009384`*^9, 3.657884250172843*^9}, {3.6578845211860394`*^9, 
   3.6578845521550956`*^9}, {3.657886421862692*^9, 3.657886423268717*^9}, {
   3.6578867861584053`*^9, 3.6578867877052975`*^9}, {3.6578878143618107`*^9, 
   3.6578878203250613`*^9}, {3.6578880603365245`*^9, 
   3.6578880809411306`*^9}, {3.657888259567726*^9, 3.6578883855520616`*^9}, {
   3.657888423290785*^9, 3.657888714676004*^9}, {3.6578887586041574`*^9, 
   3.6578888669059267`*^9}, {3.6578889155784187`*^9, 
   3.6578889432220163`*^9}, {3.6578890124841423`*^9, 
   3.6578890177128487`*^9}, {3.6578890577362204`*^9, 
   3.6578892504027967`*^9}, {3.657889626595443*^9, 3.6578896388451324`*^9}, {
   3.6578896862607665`*^9, 3.65788969069388*^9}, {3.6578901615156345`*^9, 
   3.6578901620970755`*^9}, {3.657892159864362*^9, 3.657892200014852*^9}, {
   3.6578922459884195`*^9, 3.657892246217575*^9}, {3.657892352716099*^9, 
   3.6578923901216135`*^9}, {3.658822172709695*^9, 3.658822276288286*^9}, {
   3.6588236504475603`*^9, 3.6588236539120197`*^9}, {3.6588260723927593`*^9, 
   3.6588261511627426`*^9}, {3.6588262827021933`*^9, 3.658826324333774*^9}, {
   3.658826378654345*^9, 3.65882638025248*^9}, {3.6588277815657473`*^9, 
   3.658827871754845*^9}, {3.658828685997028*^9, 3.6588286896826515`*^9}, {
   3.658828724237197*^9, 3.6588287471274595`*^9}, {3.6588288333126884`*^9, 
   3.658828864298733*^9}, {3.6588295715431814`*^9, 3.6588295736997395`*^9}, {
   3.658829616374029*^9, 3.6588296169794583`*^9}, {3.658829776083513*^9, 
   3.6588297865289326`*^9}, {3.658829880541707*^9, 3.658830134939474*^9}, {
   3.658901939517967*^9, 3.658901967286716*^9}, {3.658904035761856*^9, 
   3.6589040840942106`*^9}, {3.6589041558431673`*^9, 3.6589042013665276`*^9}, 
   3.658904234457019*^9, {3.6589043147180414`*^9, 3.6589043196095295`*^9}, {
   3.658904714037739*^9, 3.6589047292015123`*^9}, {3.658904861838745*^9, 
   3.6589048721070404`*^9}, {3.6589049085069246`*^9, 3.658904910481303*^9}, {
   3.6589049449748163`*^9, 3.658904966806337*^9}, {3.658905006074246*^9, 
   3.658905021327057*^9}, {3.6589051044127064`*^9, 3.658905105380377*^9}, {
   3.658905135569829*^9, 3.658905148314904*^9}, {3.658905667821966*^9, 
   3.6589056710512624`*^9}, 3.6589062723044205`*^9, {3.658906933127906*^9, 
   3.6589071003737335`*^9}, {3.6589071565836596`*^9, 
   3.6589072211715546`*^9}, {3.6589074190741663`*^9, 3.658907497909175*^9}, 
   3.658908168116454*^9, {3.707784251343779*^9, 3.70778425268193*^9}, {
   3.707784863146286*^9, 3.7077848676203003`*^9}, {3.707813545522915*^9, 
   3.707813603478592*^9}, {3.707813940309257*^9, 3.7078139774135523`*^9}, {
   3.707814036530592*^9, 3.7078140690633497`*^9}, {3.7078141330304832`*^9, 
   3.707814148960643*^9}, {3.707814245473654*^9, 3.7078142456022043`*^9}, 
   3.707837028484391*^9, {3.707837078975231*^9, 3.70783714603197*^9}, {
   3.7078395363147*^9, 3.707839580995022*^9}, {3.707839705980425*^9, 
   3.70783970810802*^9}, {3.7078397402514153`*^9, 3.7078397442952127`*^9}, {
   3.707839849312891*^9, 3.707839896418376*^9}, {3.7078403943987837`*^9, 
   3.707840416093899*^9}},ExpressionUUID->"50a09b53-ac34-4da4-8394-\
7c035ee39bb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"HuMoments", "[", "\[Eta]_List", "]"}], ":=", 
  RowBox[{"Module", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"hu", "=", " ", 
       RowBox[{"{", 
        RowBox[{
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{"len", " ", "=", " ", 
       RowBox[{"Length", "@", "\[Eta]"}]}]}], "\[IndentingNewLine]", "\t", 
     "}"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"len", "\[Equal]", "7"}], ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"hu", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{"\[Eta]", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "+", 
         RowBox[{"\[Eta]", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"hu", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "2"], "+", 
         RowBox[{"4", 
          SuperscriptBox[
           RowBox[{"\[Eta]", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "2"]}]}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"hu", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "-", 
            RowBox[{"3", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "-", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "2"]}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"hu", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "=", " ", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "+", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "+", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "2"]}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"hu", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "-", 
            RowBox[{"3", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "+", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "+", 
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "2"], "-", 
            RowBox[{"3", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "+", 
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "2"]}]}], ")"}]}], 
         "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "-", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "+", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "2"]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "5", "]"}], "]"}], "+", 
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "2"]}], ")"}]}]}]}], 
       ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"hu", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "+", 
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "2"], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "5", "]"}], "]"}], "+", 
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "2"]}], ")"}]}], "+", 
         RowBox[{"4", 
          RowBox[{"\[Eta]", "[", 
           RowBox[{"[", "2", "]"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "+", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "+", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"hu", "[", 
         RowBox[{"[", "7", "]"}], "]"}], "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "-", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "+", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "+", 
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "2"], "-", 
            RowBox[{"3", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], "+", 
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "2"]}]}], ")"}]}], 
         "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "-", 
            RowBox[{"3", 
             RowBox[{"\[Eta]", "[", 
              RowBox[{"[", "6", "]"}], "]"}]}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "5", "]"}], "]"}], "+", 
            RowBox[{"\[Eta]", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "+", 
                RowBox[{"\[Eta]", "[", 
                 RowBox[{"[", "6", "]"}], "]"}]}], ")"}], "2"]}], "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "5", "]"}], "]"}], "+", 
               RowBox[{"\[Eta]", "[", 
                RowBox[{"[", "7", "]"}], "]"}]}], ")"}], "2"]}], ")"}]}]}]}], 
       ";", "hu"}], ",", "\"\<Error\>\""}], "]"}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.7078360135330887`*^9, 3.7078360147633553`*^9}, {
  3.707836117576573*^9, 3.70783616782819*^9}, {3.7078370605416727`*^9, 
  3.7078370636932373`*^9}, {3.707837151247365*^9, 3.7078371830244293`*^9}, {
  3.708189069719528*^9, 
  3.708189070629571*^9}},ExpressionUUID->"130d256f-54b2-4501-85a9-\
eae0687ad773"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Funciton", " ", "to", " ", "generate", " ", "Cellular", " ", "Atuomata", 
    " ", 
    RowBox[{"matrices", "/", "images"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"generateMatrix", "[", 
    RowBox[{"rule_", ",", " ", "steps_", ",", " ", "p_"}], "]"}], " ", ":=", 
   " ", "\n", 
   RowBox[{
    RowBox[{"ruleImage", "[", "rule", "]"}], " ", "=", " ", 
    RowBox[{"Table", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Binarize", "[", "\n", "\t\t\t", 
       RowBox[{"Image", "[", 
        RowBox[{"CellularAutomaton", "[", "\n", "\t\t\t\t", 
         RowBox[{"rule", ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"IntegerDigits", "[", 
             RowBox[{"i", ",", " ", "2", ",", " ", "p"}], "]"}], ",", " ", 
            "0"}], "}"}], ",", "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"steps", ",", " ", "All"}], "}"}]}], "\n", "\t\t\t", "]"}],
         "]"}], "]"}], ",", "\n", "\t", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"2", "^", "p"}], "-", "1"}]}], "}"}]}], "\n", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.707602744391719*^9, 3.707602806163169*^9}, {
  3.707690995162005*^9, 3.707691006534696*^9}, {3.707734839953218*^9, 
  3.707734851569561*^9}, {3.7078349593445807`*^9, 
  3.7078349598134413`*^9}},ExpressionUUID->"ee3c5247-ed42-4b75-9b0f-\
1ab424b67d25"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$properties", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Count\>\"", ",", " ", "\"\<Area\>\"", ",", " ", 
      "\"\<PerimeterCount\>\"", ",", " ", "\"\<FilledCount\>\"", ",", " ", 
      "\"\<NeighborCount\>\"", ",", "\"\<EulerNumber\>\"", ",", " ", 
      "\"\<Holes\>\"", ",", " ", "\"\<Eccentricity\>\"", ",", " ", 
      "\"\<Width\>\"", ",", "\"\<Length\>\"", " ", ",", " ", 
      "\"\<ConvexArea\>\"", ",", "\"\<BoundingBoxArea\>\""}], "}"}]}], ";"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.707778284695786*^9, 3.707778288256133*^9}, {
  3.707779937350789*^9, 3.707779938212204*^9}, {3.7077817205643597`*^9, 
  3.7077817219025173`*^9}, {3.707818189556798*^9, 3.70781819045856*^9}, {
  3.707833844087311*^9, 3.707833867381558*^9}, {3.708083282317861*^9, 
  3.708083286032381*^9}, {3.708083636094509*^9, 3.708083649716536*^9}, {
  3.708083970194935*^9, 3.708084082580717*^9}, {3.70808418691681*^9, 
  3.708084215885214*^9}, {3.708089964269149*^9, 3.708089966998405*^9}, {
  3.708090121758438*^9, 3.708090159628166*^9}, {3.708257840449182*^9, 
  3.7082578413751717`*^9}},ExpressionUUID->"e78cbe57-42e5-40ac-beb6-\
13e82625b935"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Function", " ", "to", " ", "find", " ", "feaatures", " ", "of", " ", "a",
      " ", "given", " ", "cellular", " ", "automata", " ", 
     RowBox[{"image", ".", " ", "The"}], " ", "set", " ", "of", " ", 
     "proposed", " ", "features", " ", "include", "\n", "\t", "1.", " ", 
     "Solidity", "\n", "\t", "2.", " ", "Axis", " ", "Ratio", "\n", "\t", 
     "3.", " ", "Areas", " ", "Ratio", "\n", "\t", "4.", " ", "Perimeter"}], 
    "-", 
    RowBox[{
    "Area", " ", "Ratio", "\n", "\t", "5.", " ", "Eccentricity", "\n", "\t", 
     "6.", " ", "Extent", "\n", "\t", "7.", " ", "Invariant", " ", "moment", 
     " ", 
     RowBox[{"(", "Hu7", ")"}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"featureVector1", "[", "singleImg_", "]"}], ":=", " ", "\n", 
   RowBox[{"Module", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
      "part", ",", " ", "props", ",", " ", "returnList", ",", " ", 
       "newProps"}], "\n", "\t", "}"}], ",", "\t", "\n", "\t", 
     RowBox[{
      RowBox[{"props", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"First", "[", 
          RowBox[{"#", ",", " ", "$MachineEpsilon"}], "]"}], "&"}], " ", "/@",
         " ", 
        RowBox[{"ComponentMeasurements", "[", "\n", "\t\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"singleImg", ",", " ", 
            RowBox[{"ImageData", "[", 
             RowBox[{"singleImg", ",", " ", "\"\<Bit\>\""}], "]"}]}], "}"}], 
          ",", " ", "\n", "\t\t", "$properties", ",", "\n", "\t\t", 
          "\"\<PropertyAssociation\>\""}], "\n", "\t", "]"}]}]}], ";", "\n", 
      "\t", "\n", "\t", 
      RowBox[{"newProps", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "#Count", ",", " ", "\n", "\t\t\t\t", "#Area", ",", " ", "\n", 
           "\t\t\t\t", "#FilledCount", ",", " ", "\n", "\t\t\t\t", 
           "#NeighborCount", ",", " ", "\n", "\t\t\t\t", "#Holes", ",", " ", 
           "\n", "\t\t\t\t", "#EulerNumber", ",", " ", "\n", "\t\t\t\t", 
           RowBox[{"#Area", "/", "#ConvexArea"}], ",", " ", "\n", "\t\t\t\t", 
           
           RowBox[{"#Width", "/", "#Length"}], ",", " ", "\n", "\t\t\t\t", 
           RowBox[{"#Area", "/", "#FilledCount"}], ",", " ", "\n", "\t\t\t\t", 
           RowBox[{"#PerimeterCount", "/", "#Area"}], ",", " ", "\n", 
           "\t\t\t\t", 
           RowBox[{"#Area", "/", "#BoundingBoxArea"}], ",", "\n", "\t\t\t\t", 
           "#Eccentricity"}], "}"}], "&"}], " ", "@", " ", "props"}]}], ";", 
      "\n", "\t\t\t\t", "\n", "\t", 
      RowBox[{"returnList", " ", "=", " ", "newProps"}], ";", "\n", "\t", 
      RowBox[{"Join", "[", 
       RowBox[{"returnList", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Part", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"HuMoments", "@*", "imageMoments"}], ")"}], "[", 
            "singleImg", "]"}], ",", " ", "7"}], "]"}], "}"}]}], "]"}]}]}], 
    "\n", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.707675162686454*^9, 3.707675201560836*^9}, {
   3.707675284778593*^9, 3.707675299529632*^9}, {3.707675339174629*^9, 
   3.707675347208901*^9}, {3.7076806788283587`*^9, 3.707680683415449*^9}, {
   3.707680727136158*^9, 3.7076807420398006`*^9}, {3.7076890916586933`*^9, 
   3.70768909525881*^9}, {3.7076891296937637`*^9, 3.70768913145148*^9}, {
   3.7076891662700653`*^9, 3.7076891715648813`*^9}, {3.707689574199976*^9, 
   3.707689582236719*^9}, {3.7076896472742*^9, 3.707689656087907*^9}, {
   3.7076905129797707`*^9, 3.707690538450634*^9}, 3.707690583021047*^9, {
   3.7076923908978443`*^9, 3.7076923968452263`*^9}, {3.707692858497013*^9, 
   3.707692866977956*^9}, {3.7077211362777567`*^9, 3.707721182629109*^9}, {
   3.707721239034295*^9, 3.707721242470036*^9}, 3.707735770094327*^9, {
   3.7077370467742023`*^9, 3.707737050940857*^9}, {3.707737158547336*^9, 
   3.70773719996201*^9}, 3.7077372463651237`*^9, {3.707737729879736*^9, 
   3.707737737116435*^9}, {3.7077379214222803`*^9, 3.7077379490077543`*^9}, {
   3.707753590214727*^9, 3.707753632558033*^9}, {3.7077536826354523`*^9, 
   3.707753691513041*^9}, {3.707753839227713*^9, 3.707753934612513*^9}, {
   3.7077541186568117`*^9, 3.707754149273144*^9}, {3.7077543639236813`*^9, 
   3.7077543859554462`*^9}, {3.707754451265192*^9, 3.7077544711224403`*^9}, {
   3.707758319741551*^9, 3.707758375775819*^9}, {3.707758501445181*^9, 
   3.707758506315757*^9}, {3.707774198143564*^9, 3.7077745365742483`*^9}, {
   3.707774575835848*^9, 3.707774684141096*^9}, {3.7077751886416693`*^9, 
   3.707775193692019*^9}, {3.707775897309991*^9, 3.707775905830777*^9}, {
   3.7077760192595043`*^9, 3.707776019458681*^9}, {3.707776131202756*^9, 
   3.707776134362706*^9}, {3.707776229993981*^9, 3.707776241993039*^9}, {
   3.7077763379664907`*^9, 3.70777634689555*^9}, {3.70777642878133*^9, 
   3.70777642994842*^9}, {3.707776567403811*^9, 3.7077765736762657`*^9}, {
   3.707776611494771*^9, 3.707776623639505*^9}, {3.707776856182352*^9, 
   3.707776906633397*^9}, {3.707777054073083*^9, 3.707777070779297*^9}, {
   3.707777341928082*^9, 3.707777347112656*^9}, {3.707777466866461*^9, 
   3.7077774725293427`*^9}, {3.707777515525359*^9, 3.7077775426306973`*^9}, {
   3.707777603074648*^9, 3.707777603681226*^9}, {3.707777672639312*^9, 
   3.707777680301626*^9}, {3.7077777194573174`*^9, 3.707777796956504*^9}, 
   3.70777804262006*^9, {3.707778219574916*^9, 3.707778389152822*^9}, {
   3.7077784408761597`*^9, 3.707778465037691*^9}, {3.7077799436150427`*^9, 
   3.707780048816581*^9}, {3.707781762965947*^9, 3.707781779373518*^9}, {
   3.707817668921275*^9, 3.7078176803212547`*^9}, {3.707817876356983*^9, 
   3.707817926896596*^9}, {3.707818348147955*^9, 3.707818375181157*^9}, {
   3.707818434222782*^9, 3.707818460855268*^9}, {3.707818491927824*^9, 
   3.7078185040104227`*^9}, {3.707818649564159*^9, 3.707818694395742*^9}, {
   3.707818795584792*^9, 3.707818799864723*^9}, {3.7078189518194923`*^9, 
   3.707818959825869*^9}, {3.7078190998811283`*^9, 3.7078191032399282`*^9}, {
   3.707819325897189*^9, 3.707819346512498*^9}, {3.7078194357815447`*^9, 
   3.707819436380344*^9}, {3.7078194896899233`*^9, 3.707819501021525*^9}, {
   3.707819552593376*^9, 3.7078195684350758`*^9}, {3.707833003645823*^9, 
   3.707833003985221*^9}, {3.707833472462676*^9, 3.707833538509501*^9}, {
   3.707833803671227*^9, 3.70783388172057*^9}, {3.7078343769614553`*^9, 
   3.707834377203574*^9}, {3.707834490384997*^9, 3.707834493403593*^9}, {
   3.707834931850425*^9, 3.707834946968544*^9}, {3.7078350096301117`*^9, 
   3.7078350143398867`*^9}, {3.707837322374935*^9, 3.707837335685522*^9}, {
   3.707837403312324*^9, 3.7078374055028753`*^9}, {3.707837614606368*^9, 
   3.70783762868499*^9}, 3.7078377539066973`*^9, {3.707837806115333*^9, 
   3.7078378506586447`*^9}, {3.7078400564465847`*^9, 3.707840070503179*^9}, {
   3.707840130028696*^9, 3.70784014872641*^9}, {3.707840221679862*^9, 
   3.7078402675998573`*^9}, {3.707840316058483*^9, 3.707840329674369*^9}, {
   3.7078405129527617`*^9, 3.707840515583641*^9}, {3.707840565025482*^9, 
   3.7078405668575277`*^9}, {3.707840665612506*^9, 3.707840706653077*^9}, {
   3.707840756576064*^9, 3.707840778431506*^9}, {3.707930786167408*^9, 
   3.70793082453487*^9}, {3.707930938325945*^9, 3.707930939292368*^9}, {
   3.707930997801537*^9, 3.70793101078561*^9}, {3.708078449984469*^9, 
   3.708078465626195*^9}, {3.708078589234449*^9, 3.70807866447818*^9}, {
   3.708079113732959*^9, 3.7080791140602713`*^9}, {3.708081068350114*^9, 
   3.708081068964108*^9}, {3.7080812271608257`*^9, 3.708081242315765*^9}, {
   3.7080814111041718`*^9, 3.708081423495042*^9}, {3.7080817159611464`*^9, 
   3.7080817162011347`*^9}, {3.708083132230321*^9, 3.708083152688196*^9}, {
   3.708083317673717*^9, 3.708083319158784*^9}, {3.708083488076331*^9, 
   3.708083499780148*^9}, {3.708083591336473*^9, 3.7080836278493853`*^9}, {
   3.708083693852681*^9, 3.708083776742786*^9}, {3.708084109654562*^9, 
   3.7080841440796127`*^9}, {3.708084280239962*^9, 3.708084288853464*^9}, {
   3.7080843423630667`*^9, 3.708084344872979*^9}, {3.708084480915691*^9, 
   3.708084482553348*^9}, {3.7080861913885*^9, 3.708086208934017*^9}, {
   3.708089909062888*^9, 3.7080899312380953`*^9}, {3.708259655644023*^9, 
   3.7082596811018753`*^9}},ExpressionUUID->"277d7ba5-db52-4146-9caa-\
658c0bb960cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateRuleVectors", "[", 
   RowBox[{"rule_", ",", " ", "steps_", ",", " ", "p_"}], "]"}], ":=", "\n", 
  "\t", 
  RowBox[{
   RowBox[{
    RowBox[{"featureVector1", "[", "#", "]"}], "&"}], "/@", 
   RowBox[{"generateMatrix", "[", 
    RowBox[{"rule", ",", " ", "steps", ",", " ", "p"}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.707777404725947*^9, 3.707777434541945*^9}, {
  3.707777475850968*^9, 
  3.707777479448468*^9}},ExpressionUUID->"b986f0b8-7bee-48ff-81ac-\
fc0e33466687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"clusterRule", "[", "ruleNum_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"features", " ", "=", " ", "Null"}], "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", "ruleNum", "]"}], " ", "=", " ", 
      RowBox[{"generateRuleVectors", "[", 
       RowBox[{"ruleNum", ",", " ", "60", ",", " ", "8"}], "]"}]}], ";", "\n",
      "\t", 
     RowBox[{"features", " ", "=", " ", 
      RowBox[{"Standardize", "[", 
       RowBox[{"r", "[", "ruleNum", "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"k", " ", "=", " ", 
      RowBox[{"Length", "@", 
       RowBox[{"FindClusters", "[", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"r", "[", "ruleNum", "]"}], ",", " ", 
         RowBox[{"Method", "->", "\"\<NeighborhoodContraction\>\""}], ",", 
         " ", "\n", "\t\t\t", 
         RowBox[{"CriterionFunction", "->", "\"\<StandardDeviation\>\""}]}], 
        "\n", "\t\t", "]"}]}]}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"clus", "[", "ruleNum", "]"}], " ", "=", " ", 
      RowBox[{"FindClusters", "[", "\n", "\t\t", 
       RowBox[{
        RowBox[{"features", "\[Rule]", 
         RowBox[{"Thread", "[", 
          RowBox[{"features", "\[Rule]", 
           RowBox[{"ruleImage", "[", "ruleNum", "]"}]}], "]"}]}], ",", "\n", 
        "\t\t", "k", ",", " ", 
        RowBox[{"Method", "\[Rule]", "\"\<KMeans\>\""}]}], "\n", "\t", 
       "]"}]}], ";", " ", "\n", "\t", "\n", "\t", 
     RowBox[{"generateStats", "[", 
      RowBox[{"clus", "[", "ruleNum", "]"}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Code",
 CellChangeTimes->{{3.7081907792444057`*^9, 3.70819078266713*^9}, {
   3.7081908421904297`*^9, 3.708190973934284*^9}, {3.708191066837607*^9, 
   3.708191091806254*^9}, {3.708191160404359*^9, 3.708191260143722*^9}, {
   3.708191294820035*^9, 3.708191440490748*^9}, {3.7081914827408667`*^9, 
   3.708191644591105*^9}, {3.708191754487464*^9, 3.708191759118451*^9}, {
   3.708191796778018*^9, 3.708191801455744*^9}, 3.7081918768218946`*^9, {
   3.7081935928650103`*^9, 3.708193593279756*^9}, {3.7081980181557093`*^9, 
   3.7081980223857813`*^9}, {3.708198591965674*^9, 3.7081986118361*^9}, {
   3.708198667221818*^9, 3.7081986680273647`*^9}, {3.7081992111924067`*^9, 
   3.708199211477748*^9}, {3.708199438835209*^9, 3.708199438913575*^9}, {
   3.708200121555389*^9, 3.7082001275211*^9}, {3.708258030937889*^9, 
   3.708258032912118*^9}},ExpressionUUID->"3df1fd33-2518-4b0b-aa41-\
058cacc208cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateStats", "[", "clus_", "]"}], ":=", " ", "\n", "\t", 
  RowBox[{"Module", "[", " ", "\n", "\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"vecs", " ", "=", " ", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "All", ",", " ", "1"}], "]"}], "]"}]}], ",",
       "\n", "\t\t", 
      RowBox[{"imgs", " ", "=", " ", 
       RowBox[{"clus", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}]}], ",",
       "\n", "\t\t", 
      RowBox[{"clusLength", " ", "=", " ", "0"}]}], "\n", "\t", "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"(*", 
     RowBox[{"Bar", " ", "char", " ", "of", " ", "cluster", " ", "lenghts"}], 
     "*)"}], "\n", "\t", 
    RowBox[{
     RowBox[{"BarChart", "[", 
      RowBox[{
       RowBox[{"Map", "[", "\n", "\t\t", 
        RowBox[{"Length", ",", " ", "vecs"}], "]"}], ",", "\n", "\t\t", 
       RowBox[{"PlotLabel", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Clusters size\>\"", ",", " ", "16"}], "]"}]}], ",", 
       "\n", "\t\t", 
       RowBox[{"ChartStyle", "\[Rule]", "\"\<DarkRainbow\>\""}], ",", " ", 
       RowBox[{"BarOrigin", "\[Rule]", "Left"}], ",", " ", 
       RowBox[{"LabelingFunction", "\[Rule]", "After"}]}], "\n", "\t", "]"}], 
     ";", "\n", "\t", 
     RowBox[{"(*", 
      RowBox[{
      "Pick", " ", "one", " ", "image", " ", "of", " ", "each", " ", 
       "cluster"}], "*)"}], "\n", "\t", 
     RowBox[{"clusLength", " ", "=", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"clus", "//", "Dimensions"}], ")"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"RandomChoice", "[", 
        RowBox[{"clus", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", " ", "All", ",", " ", "2"}], "]"}], "]"}], "]"}], 
       ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "1", ",", " ", "clusLength"}], "}"}]}], 
      "]"}]}]}], "\n", "]"}]}]], "Code",
 CellChangeTimes->{{3.708190976812867*^9, 3.708191026760891*^9}, {
   3.708191312965191*^9, 3.70819132277063*^9}, {3.7081916493906307`*^9, 
   3.708191713524623*^9}, {3.7081918391724586`*^9, 3.708191839289404*^9}, {
   3.708191881470397*^9, 3.708191905109548*^9}, {3.708191959459383*^9, 
   3.708191991306612*^9}, {3.7081920285984087`*^9, 3.7081921093454723`*^9}, {
   3.708192153940967*^9, 3.708192171477201*^9}, {3.708192227274824*^9, 
   3.708192392507339*^9}, {3.7081924254064913`*^9, 3.708192453031637*^9}, {
   3.708193342448922*^9, 3.708193524941485*^9}, {3.708195315840317*^9, 
   3.708195321968773*^9}, {3.708196399273876*^9, 3.708196419207458*^9}, {
   3.708196458500478*^9, 3.70819647000674*^9}, 3.708196675511856*^9, {
   3.708196739024379*^9, 3.708196742536618*^9}, {3.7081971297692223`*^9, 
   3.708197130967779*^9}, {3.708197243944648*^9, 3.708197339612772*^9}, {
   3.70819739483635*^9, 3.708197446877761*^9}, {3.708197498771389*^9, 
   3.7081975006257*^9}, {3.7081977151165857`*^9, 3.70819774234195*^9}, {
   3.7081977745374203`*^9, 3.708197986017177*^9}, {3.708198394624148*^9, 
   3.708198442785186*^9}, {3.70819849434086*^9, 3.708198522231525*^9}, {
   3.708198570583557*^9, 3.708198576510419*^9}, {3.708198640812347*^9, 
   3.708198811067032*^9}},ExpressionUUID->"715736a5-546d-4c34-aa3b-\
fabd7464c951"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Compare", " ", "cluster", " ", "variations", " ", "for", " ", "cellular",
      " ", "automata", " ", "using", " ", "30"}], "-", 
    RowBox[{"100", " ", 
     RowBox[{"steps", " ", "--"}], 
     RowBox[{"Unfinished", "--"}]}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"compareGens", "[", "ruleNum_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{"gens", ",", "len"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{
      RowBox[{"gens", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"generateRuleVectors", "[", 
          RowBox[{"ruleNum", ",", " ", "60", ",", " ", "i"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "6", ",", " ", "10"}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\t", 
      RowBox[{"len", " ", "=", " ", 
       RowBox[{"Length", "@", "gens"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"lens", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Length", "@", 
          RowBox[{"FindClusters", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"gens", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
            RowBox[{"Method", "->", "\"\<NeighborhoodContraction\>\""}], ",", 
            " ", "\n", "\t\t\t\t\t", 
            RowBox[{
            "CriterionFunction", "->", "\"\<StandardDeviation\>\""}]}], "\n", 
           "\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "1", ",", " ", "len"}], "}"}]}], "\n", 
        "\t\t\t", "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"st", " ", "=", " ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Standardize", "[", "#", "]"}], "&"}], ",", " ", "gens"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"compClus", " ", "=", " ", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"FindClusters", "[", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"st", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
            RowBox[{"Thread", "[", 
             RowBox[{
              RowBox[{"st", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{"ruleImage", "[", "ruleNum", "]"}], ",", 
                RowBox[{"2", "^", 
                 RowBox[{"(", 
                  RowBox[{"i", "+", "5"}], ")"}]}]}], "]"}]}], "]"}]}], ",", 
           "\n", "\t\t\t", 
           RowBox[{"lens", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"Method", "\[Rule]", "\"\<KMeans\>\""}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\t\t", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "len"}], "}"}]}], "\[IndentingNewLine]", 
        "\t", "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Code",
 CellChangeTimes->{{3.708261868323728*^9, 3.7082619120467577`*^9}, {
  3.708261947799192*^9, 
  3.708261975432652*^9}},ExpressionUUID->"3836adb4-9b7e-4afd-b612-\
bb0f1b374296"]
},
WindowSize->{808, 651},
WindowMargins->{{52, Automatic}, {Automatic, 4}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 27, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 287, 6, 32, "Input", "ExpressionUUID" -> \
"7970e5e9-c54e-4918-8772-9d4220a149e0"],
Cell[848, 28, 283, 7, 32, "Input", "ExpressionUUID" -> \
"c7e5a6ef-c5ca-4d46-8086-3f28663edd08"],
Cell[1134, 37, 13603, 328, 944, "Code", "ExpressionUUID" -> \
"50a09b53-ac34-4da4-8394-7c035ee39bb8"],
Cell[14740, 367, 9757, 268, 242, "Code", "ExpressionUUID" -> \
"130d256f-54b2-4501-85a9-eae0687ad773"],
Cell[24500, 637, 1448, 36, 192, "Code", "ExpressionUUID" -> \
"ee3c5247-ed42-4b75-9b0f-1ab424b67d25"],
Cell[25951, 675, 1198, 22, 59, "Input", "ExpressionUUID" -> \
"e78cbe57-42e5-40ac-beb6-13e82625b935"],
Cell[27152, 699, 8443, 142, 559, "Code", "ExpressionUUID" -> \
"277d7ba5-db52-4146-9caa-658c0bb960cd"],
Cell[35598, 843, 519, 13, 72, "Code", "ExpressionUUID" -> \
"b986f0b8-7bee-48ff-81ac-fc0e33466687"],
Cell[36120, 858, 2576, 51, 319, "Code", "ExpressionUUID" -> \
"3df1fd33-2518-4b0b-aa41-058cacc208cf"],
Cell[38699, 911, 3424, 72, 357, "Code", "ExpressionUUID" -> \
"715736a5-546d-4c34-aa3b-fabd7464c951"],
Cell[42126, 985, 3323, 79, 433, "Code", "ExpressionUUID" -> \
"3836adb4-9b7e-4afd-b612-bb0f1b374296"]
}
]
*)

